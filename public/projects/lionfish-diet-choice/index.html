<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Amelia L. Ritger">

  
  
  
    
  
  <meta name="description" content="Diet choice in marine species is typically derived from indirect methods such as stomach contents and stable isotope analysis, while choice experiments in controlled laboratory settings are used to infer foraging decisions in the wild. However, these methods are limited in their capacity to make inferences about foraging decisions by predators in variable environments or recreate the array of factors (such as prey traits, predator condition, and environmental conditions) present in natural systems which may interact to affect diet decisions by predators.">

  
  <link rel="alternate" hreflang="en-us" href="/projects/lionfish-diet-choice/">

  


  
  
  
  <meta name="theme-color" content="#A82D0F">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alice%7CAlegreya%7CCrimson+Text%7CCabin+Condensed&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/projects/lionfish-diet-choice/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@ameliaritger">
  <meta property="twitter:creator" content="@ameliaritger">
  
  <meta property="og:site_name" content="Amelia L. Ritger">
  <meta property="og:url" content="/projects/lionfish-diet-choice/">
  <meta property="og:title" content="Lionfish diet choice experiment | Amelia L. Ritger">
  <meta property="og:description" content="Diet choice in marine species is typically derived from indirect methods such as stomach contents and stable isotope analysis, while choice experiments in controlled laboratory settings are used to infer foraging decisions in the wild. However, these methods are limited in their capacity to make inferences about foraging decisions by predators in variable environments or recreate the array of factors (such as prey traits, predator condition, and environmental conditions) present in natural systems which may interact to affect diet decisions by predators."><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-01-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-01-09T15:02:28-08:00">
  

  



  


  


  





  <title>Lionfish diet choice experiment | Amelia L. Ritger</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Amelia L. Ritger</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Amelia L. Ritger</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#research"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#mentorship"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://ameliaritger.shinyapps.io/mbon-shiny-app/" target="_blank" rel="noopener"><span>Shiny</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Lionfish diet choice experiment</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Jan 9, 2020
  </span>
  

  

  

  
  
  

  
  

</div>

    













<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/ameliaritger/lionfish-diet-choice" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Repository
  </a>


</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Diet choice in marine species is typically derived from indirect methods such as stomach contents and stable isotope analysis, while choice experiments in controlled laboratory settings are used to infer foraging decisions in the wild. However, these methods are limited in their capacity to make inferences about foraging decisions by predators in variable environments or recreate the array of factors (such as prey traits, predator condition, and environmental conditions) present in natural systems which may interact to affect diet decisions by predators. Recent work has provided evidence for selectivity in the invasive Indo-Pacific lionfish (Pterois volitans/miles) despite the predator’s apparent opportunistic, generalist feeding behavior. We directly tested diet choice by presenting wild-caught lionfish with multi-species prey assemblages in field enclosures. We offered lionfish equal biomasses of prey species sharing similar prey traits that are both highly abundant on coral reefs and prevalent in the lionfish diet across the invaded range. We then applied compositional analyses to determine relative prey consumption given prey availability. We observed lionfish selectively foraging on prey and manifesting strong consistent preferences for one prey species. Additionally, we observed condition-dependent foraging behavior, as lionfish with higher body conditions were more likely to exhibit selective foraging behavior. Our findings provide direct evidence for diet choice in an invasive generalist species and highlight the importance of preserving the ecological complexity of natural ecosystems in choice experiments, particularly when investigating predator-prey interactions in complex environments.</p>
<p>The following code walks through the data analysis for this project:</p>
<pre class="r"><code># Lion fish preference index
# june 2018 written
# Cleaned by Amelia Ritger in January 2020

###############################################################
# save.image(&quot;lionfish.RData&quot;)
# load(&quot;lionfish.RData&quot;)
###############################################################
##RUN THIS
data_all &lt;- read.csv(&quot;lionfishdata.csv&quot;)

data_x &lt;-data.frame(Starve_time = data_all$Starvationtime_hours,
                    cloudcover = data_all$Cloudcover,sex = data_all$Sex,
                    lf_std_length = data_all$Lionfishstandardlength_cm, lf_wetwgt = data_all$LionfishWetWeight_g,
                    mooncycle = data_all$Mooncycle,depthcaptured = data_all$Depthcaptured_m,bodycond = data_all$BodyCondition,Lionfish_totlength = data_all$Lionfishtotallength_cm)
counts &lt;- data.frame(N_chromis = data_all$Numberchromisconsumed, N_goby = data_all$Numbergobyconsumed,N_wrasse = data_all$Numberwrasseconsumed)
########################
# Use zCompositions to replace zeros using bayesian multiplicative methods
library(&#39;zCompositions&#39;)
c_tot &lt;- counts$N_chromis + counts$N_wrasse + counts$N_goby
rep_p &lt;- cmultRepl(counts,method = &quot;SQ&quot;) # proportions data with zeros replaced</code></pre>
<pre><code>## No. corrected values:  3</code></pre>
<pre class="r"><code>rep_count&lt;-rep_p*c_tot

colnames(rep_count) &lt;- colnames(rep_p) &lt;- colnames(counts)

rep_biomass &lt;- rep_count*matrix(rep(c(0.641,0.129,0.655),nrow = nrow(rep_count)))
###################################
# MAIL MICHELE:
### 11chromis, 55 gobies, 11wrasses
#############################
# T^2 hotelling
library(rrcov)
#
fsbp2ilr&lt;-function(s){
  # given a vector (or a set of vectors) of a SBP formed by 0,+1,-1 
  # returns the ilr-vector (or set of) or balance
  # author: Martin (2015)
  
  bal=s
  
  if(is.null(dim(s))) 
  {
    
    den&lt;-sum(bal==-1)
    num&lt;-sum(bal==1)  
    bal[s==1]&lt;-sqrt(den/((den+num)*num))
    bal[s==-1]&lt;--sqrt(num/((den+num)*den))
    
    
  }
  else
  {
    numsbp=dim(s)[1]
    for (f in 1:numsbp) {
      den&lt;-sum(bal[f,]==-1)
      num&lt;-sum(bal[f,]==1)  
      bal[f,bal[f,]==1]&lt;-sqrt(den/((den+num)*num))
      bal[f,bal[f,]==-1]&lt;--sqrt(num/((den+num)*den))
      
    }
    
  }
  
  return(bal)
}

# AND A FEASIBLE LOG-RATIO COULD BE
tU3=as.matrix(fsbp2ilr(rbind(c(1,-1,-1),c(0,1,-1))))
U3=t(tU3)

ilr_rep_p&lt;-log(as.matrix(rep_p))%*%U3 
ilr_ref&lt;-log(as.vector(c(11,55,11)/sum(c(11,55,11))))%*%U3 
#T2.test(as.matrix(ilr_rep_p),mu=as.vector(ilr_ref))
# T2 = 80.475, F = 38.120, df1 = 2, df2 = 18, p-value = 3.383e-07
# 
#  In average, the preference of the data set is different from the NULL HIPOT
#  of NO-PREFERENCE, the (11,55,11) composition
#
#
##########################################################
# INDEX of PREFERENCE based on Aitchison distance
#########################################################
# Aitchison distance
fdAit&lt;-function(x,y){
  log(x) - mean(log(x))
  return(sqrt(sum((log(x) - mean(log(x)) - log(y) + mean(log(y)))^2)))
}
#
############################################################
# Non-Scaled Index 
fIndexPref&lt;-function (x,xref) 
{
  if (is.vector(x)) {
    return(fdAit(x,xref)^2)
  }
  else {
    return(apply(x,1,fdAit,xref)^2)
  }
}
#
# [0,1]-Scaled Index 
fIndexPrefS&lt;-function (x,xref) 
{
  if (is.vector(x)) {
    d&lt;-fdAit(x,xref)^2
  }
  else {
    d&lt;-apply(x,1,fdAit,xref)^2
  }
  return(1-exp(-d))
}
#
###############################################
# no preference
fIndexPref(c(3,15,3),c(11,55,11))</code></pre>
<pre><code>## [1] 1.972152e-31</code></pre>
<pre class="r"><code>fIndexPrefS(c(3,15,3),c(11,55,11))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code># check for the first fish
fIndexPref(rep_count[1,],c(11,55,11))</code></pre>
<pre><code>##        1 
## 3.128256</code></pre>
<pre class="r"><code>fIndexPrefS(rep_count[1,],c(11,55,11))</code></pre>
<pre><code>##         1 
## 0.9562059</code></pre>
<pre class="r"><code># for all 20 fish with counts
(lindex_count &lt;-fIndexPref(rep_count,c(11,55,11)))</code></pre>
<pre><code>##  [1] 3.1282556 6.4482142 7.0868658 7.6099070 7.0798673 1.9272730 7.0798673
##  [8] 7.6099070 3.4627070 7.2212980 6.2468504 6.2468504 7.6099070 6.2468504
## [15] 2.0280870 0.4918928 1.5206318 7.0798673 3.4627070 6.3834017</code></pre>
<pre class="r"><code>(lindexS_count &lt;-fIndexPrefS(rep_count,c(11,55,11)))</code></pre>
<pre><code>##  [1] 0.9562059 0.9984167 0.9991640 0.9995045 0.9991581 0.8544554 0.9991581
##  [8] 0.9995045 0.9686552 0.9992691 0.9980635 0.9980635 0.9995045 0.9980635
## [15] 0.8684130 0.3885321 0.7814263 0.9991581 0.9686552 0.9983106</code></pre>
<pre class="r"><code>lindex_count &lt;- as.data.frame(lindex_count)
lindexS_count &lt;- as.data.frame(lindexS_count)

# for all 20 fish with biomass
(lindex_biom &lt;-fIndexPref(rep_biomass,c(7.051,7.095,7.205)))</code></pre>
<pre><code>##  [1] 9.3055855 8.0746900 6.9824973 8.7533181 0.3465590 1.9881106 8.2232784
##  [8] 0.4693835 3.5610722 4.0478786 0.1900499 6.3436792 8.7533181 0.1900499
## [15] 2.1091024 8.5532824 5.9457466 7.1858132 8.5873856 1.6021300</code></pre>
<pre class="r"><code>(lindexS_biom &lt;-fIndexPrefS(rep_biomass,c(7.051,7.095,7.205)))</code></pre>
<pre><code>##  [1] 0.9999091 0.9996887 0.9990720 0.9998421 0.2928829 0.8630461 0.9997317
##  [8] 0.3746123 0.9715917 0.9825406 0.1730822 0.9982422 0.9998421 0.1730822
## [15] 0.8786532 0.9998071 0.9973831 0.9992427 0.9998136 0.7985331</code></pre>
<pre class="r"><code>lindex_biom &lt;- as.data.frame(lindex_biom)
lindexS_biom &lt;- as.data.frame(lindexS_biom)
############################################
# total for each fish
totalN&lt;-apply(rep_count,1,sum)
#############################################
###
####
# CORRELATION BETWEEN bodycondition and index of preference
# not scaled
cor(data_x$bodycond,lindex_count) # 0.479191</code></pre>
<pre><code>##      lindex_count
## [1,]     0.479191</code></pre>
<pre class="r"><code># WITH LOGs
cor(log(data_x$bodycond),log(lindex_count)) # 0.3974944</code></pre>
<pre><code>##      lindex_count
## [1,]    0.3974944</code></pre>
<pre class="r"><code># scaled
cor(data_x$bodycond,lindexS_count) # 0.2113215</code></pre>
<pre><code>##      lindexS_count
## [1,]     0.2113215</code></pre>
<pre class="r"><code>#
#########################################
#########################################
ait &lt;- numeric()
for (i in 1:nrow(rep_count)){ait &lt;- c(ait,fdAit(as.numeric(rep_count[i,]),c(11,55,11)))}
#########################################
#########################################
### levels curves for Scaled index
library(compositions)
##
# freq repeated
(rep_count/apply(rep_count,1,sum))</code></pre>
<pre><code>##     N_chromis     N_goby   N_wrasse
## 1  0.56566478 0.37710985 0.05722537
## 2  0.07222222 0.12068966 0.80708812
## 3  0.07222222 0.10173666 0.82604111
## 4  0.84313197 0.09150635 0.06536168
## 5  0.82559429 0.10173666 0.07266905
## 6  0.50000000 0.37500000 0.12500000
## 7  0.82559429 0.10173666 0.07266905
## 8  0.84313197 0.09150635 0.06536168
## 9  0.62309221 0.31154611 0.06536168
## 10 0.68636364 0.08484848 0.22878788
## 11 0.79310345 0.12068966 0.08620690
## 12 0.79310345 0.12068966 0.08620690
## 13 0.84313197 0.09150635 0.06536168
## 14 0.79310345 0.12068966 0.08620690
## 15 0.46366548 0.46366548 0.07266905
## 16 0.07222222 0.85510873 0.07266905
## 17 0.11111111 0.44444444 0.44444444
## 18 0.82559429 0.10173666 0.07266905
## 19 0.62309221 0.31154611 0.06536168
## 20 0.44913167 0.10173666 0.44913167</code></pre>
<pre class="r"><code>fq&lt;-c(1,1,1,3,3,1,3,3,2,1,3,3,3,3,1,1,1,3,2,1)
##

niv=seq(0.1,0.9, by=0.1)
niv&lt;-c(niv,0.99)
rad&lt;-sqrt(-log(1-niv))
plot(acomp(c(11,55,11)),labels=colnames(counts),col=&quot;black&quot;,pch=&quot;+&quot;)
plot(acomp(rep_count),labels=colnames(counts),add=TRUE,pch=20, cex=1*fq)

for (i in 1:length(niv)){
  ellipses(acomp(c(11,55,11)),diag(rep(1,3)),r=rad[i],col=&quot;black&quot;,lty=3,lwd=2)
}
legend(&quot;topright&quot;, inset=c(0,0.2),legend=c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;), 
       pch=20,pt.cex=c(0.5,1,1.5),xjust=0.5,title=&quot;fish number&quot;)</code></pre>
<p><img src="/post/lionfish-data-analysis/index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>######################################
# Martin&#39;s normalization + linear adjustment
a&lt;-0 #min possible value
b&lt;-8 #max possible value
nlindex &lt;- dplyr::pull((lindex_count-a)/(b-a)) #USE THESE VALUES

######################################
## For normalized (0,1) non-linear data
reg_data &lt;-  data.frame(Bodycondition = data_all$BodyCondition, Index=nlindex)

breaks &lt;- seq(0.011,0.018,by = 0.0001)
mse &lt;- numeric()
for (b in breaks){
  piecewise &lt;- lm(Index ~ (Bodycondition &gt; b), data = reg_data)
  mse &lt;- rbind(mse,c(b,as.numeric(sqrt(mean(summary(piecewise)$residuals^2))),as.numeric(summary(piecewise)$r.squared)))
}

b &lt;- mse[which(mse[,2] == min(mse[,2])),1]
b &lt;- 0.0124

## Two sample t-test to compare group means
library(car)
reg_data$group[reg_data$Bodycondition &gt; b] &lt;- 2
reg_data$group[reg_data$Bodycondition &lt; b] &lt;- 1
reg_data$group &lt;- as.factor(reg_data$group)
leveneTest(reg_data$Index, reg_data$group) #not signficant, variance can be considered equal (TRUE)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  1  0.0899 0.7678
##       18</code></pre>
<pre class="r"><code>t.test(reg_data$Index~reg_data$group,var.equal=TRUE)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  reg_data$Index by reg_data$group
## t = -3.1185, df = 18, p-value = 0.005934
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.6298545 -0.1227968
## sample estimates:
## mean in group 1 mean in group 2 
##       0.3988921       0.7752177</code></pre>
<pre class="r"><code>plot(reg_data$Index~reg_data$group)
  
piecewise1 &lt;- lm(Index ~ Bodycondition, data = reg_data[which(reg_data$Bodycondition &lt; b),])
piecewise2 &lt;- lm(Index ~ Bodycondition, data = reg_data[which(reg_data$Bodycondition &gt; b),])
  
piecewise &lt;- lm(Index ~ (Bodycondition &gt; b), data = reg_data)
summary(piecewise)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Index ~ (Bodycondition &gt; b), data = reg_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.71373 -0.04224  0.02676  0.11484  0.48609 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             0.3989     0.1010   3.951 0.000937 ***
## Bodycondition &gt; bTRUE   0.3763     0.1207   3.119 0.005934 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2473 on 18 degrees of freedom
## Multiple R-squared:  0.3508, Adjusted R-squared:  0.3147 
## F-statistic: 9.725 on 1 and 18 DF,  p-value: 0.005934</code></pre>
<pre class="r"><code>m_1 &lt;- 0.3989 #mean group 1
m_2 &lt;- m_1+0.3763 #mean group 2

pred1 &lt;- predict(piecewise1,newdata = data.frame(Bodycondition = breaks[breaks &lt; b]))
  pred2 &lt;- predict(piecewise2,newdata = data.frame(Bodycondition = breaks[breaks &gt; b]))

######################################
###From Amelia
library(ggplot2)
library(tidyverse)
library(grid)
#create new column for each category
norm_data &lt;-  data.frame(bodycondition = data_all$BodyCondition, index =reg_data$Index)
#names(norm_data) &lt;- c(&quot;bodycondition&quot;, &quot;lindex&quot;)
norm_data$category &lt;- ifelse(norm_data$bodycondition&lt;b, &quot;A&quot;, &quot;B&quot;)

#plot with colored thresholds
a &lt;- ggplot(norm_data, aes(x=bodycondition, y=index, color=category)) +
  geom_hline(yintercept=0.99, linetype=&quot;dashed&quot;, color=&quot;#F0E442&quot;, size=1) + #add prey preference line
  annotate(&quot;rect&quot;, xmin = -Inf, xmax = 0.0184, ymin = 0.99, ymax = Inf, fill = &quot;#F0E442&quot;, alpha = .3, color = NA) + #add prey preference olor
  geom_hline(yintercept=0.03, linetype=&quot;dashed&quot;, color=&quot;#E69F00&quot;, size=1) + #add no preference line
  annotate(&quot;rect&quot;, xmin = -Inf, xmax = 0.0184, ymin = -Inf, ymax = 0.03, fill = &quot;#E69F00&quot;, alpha = .2, color = NA) + #add no preference color
  annotate(&quot;text&quot;, x = 0.0183, y = 0.01, hjust = -0.215, vjust = 0, label=&quot;no prey preference&quot;, color = &quot;black&quot;, size=3.5) +
  annotate(&quot;text&quot;, x = 0.018, y = 1.0, hjust = -0.215, vjust = 0, label=&quot;strong prey preference&quot;, color = &quot;black&quot;, size=3.5) +
  geom_point(aes(shape=category), size=3, alpha=0.9, show.legend=FALSE) + #plot points
  scale_color_manual(values=c(&quot;#0072B2&quot;, &quot;#CC79A7&quot;)) + #manually change point colors
  labs(x=&quot;Body condition&quot;, y=&quot;Index of Selectivity&quot;) + #change axis labels
  geom_segment(x=0.011,xend=b,y=mean(pred1), yend=mean(pred1), colour=&quot;#0072B2&quot;) + #add group 1 mean line
  geom_segment(x=b,xend=0.018,y=mean(pred2), yend=mean(pred2), colour=&quot;#CC79A7&quot;) + #add group 2 mean line
  theme_classic() + #remove background crap
  theme(plot.margin=unit(c(1,3.6,0,0), &quot;cm&quot;)) + #extend plot area to allow text
  coord_cartesian(xlim = c(0.011, 0.018), clip=&quot;off&quot;) + #limit plot area
  scale_y_continuous(limits=c(0,1.02), #change min and max values on y axis
                     expand=c(0,0),
                     breaks=c(0,0.2,0.4,0.6,0.8,1.0)) +
  scale_x_continuous(limits=c(0.011, 0.0185),
                     breaks=c(0.010,0.012,0.014,0.016,0.018)) #change min and max values on x axis
#annotation_custom(grob = linesGrob(), xmin = 0.019, xmax = 0.019, ymin = 0.05, ymax = 0.95) +
#annotation_custom(grob = linesGrob(), xmin = 0.0195, xmax = 0.019, ymin = 0.05, ymax = 0.15)

# Disable clip-area.
gt &lt;- ggplot_gtable(ggplot_build(a))
gt$layout$clip[gt$layout$name == &quot;panel&quot;] &lt;- &quot;off&quot;
grid.draw(gt)</code></pre>
<p><img src="/post/lionfish-data-analysis/index_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>plot(gt)

# plot without thresholds
c &lt;- ggplot(norm_data, aes(x=bodycondition, y=index, group=category)) +
  #geom_hline(yintercept=0.99, linetype=&quot;dashed&quot;, color=&quot;#F0E442&quot;, size=1) + #add prey preference line
  #annotate(&quot;rect&quot;, xmin = -Inf, xmax = Inf, ymin = 0.99, ymax = Inf, fill = &quot;#F0E442&quot;, alpha = .3, color = NA) + #add prey preference color
  #geom_hline(yintercept=0.03, linetype=&quot;dashed&quot;, color=&quot;#E69F00&quot;, size=1) + #add no preference line
  #annotate(&quot;rect&quot;, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = 0.03, fill = &quot;#E69F00&quot;, alpha = .2, color = NA) + #add no preference color
  #annotate(&quot;text&quot;, x = 0.018, y = 0.01, hjust = -0.4, vjust = 0, label=&quot;no prey preference&quot;, color = &quot;black&quot;, size=6) +
  #annotate(&quot;text&quot;, x = 0.018, y = 1.0, hjust = -0.215, vjust = 0, label=&quot;strong prey preference&quot;, color = &quot;black&quot;, size=6) +
  #annotate(&quot;text&quot;, x = 0.0175, y = 0.065, label=&quot;no prey preference&quot;, color = &quot;black&quot;, size=4) +
  #annotate(&quot;text&quot;, x = 0.0175, y = 0.95, label=&quot;strong prey preference&quot;, color = &quot;black&quot;, size=4) +
  geom_segment(x=0.0108,xend=b,y=m_1, yend=m_1, size=1.5, linetype=&quot;dashed&quot;, color=&quot;black&quot;) + #add group 1 mean line
  geom_segment(x=b,xend=0.018,y=m_2, yend=m_2, size=1.5, linetype=&quot;dotted&quot;, color=&quot;black&quot;) + #add group 2 mean line
  geom_point(aes(color=category, fill=category), shape=21, size=7, alpha=0.9, show.legend=FALSE) + #plot points
  scale_color_manual(values=c(&quot;grey19&quot;, &quot;black&quot;)) + #manually change point colors
  scale_fill_manual(values=c(&quot;black&quot;, &quot;white&quot;)) +
  labs(x=&quot;Body condition&quot;, y=&quot;Index of Selectivity&quot;) + #change axis labels
  #annotate(&quot;segment&quot;, x=0.0175, xend=0.0175, y=0.915, yend=0.085, color=&quot;black&quot;, size=1, arrow=arrow(length=unit(0.08,&quot;npc&quot;))) + #add arrow
  theme_classic() + #remove background crap
  theme(plot.margin=unit(c(4,5,4,4), &quot;cm&quot;),
        axis.text=element_text(size=24),
        axis.title=element_text(size=30)) + #extend plot area to allow text
  scale_y_continuous(limits=c(0,1.02), #change min and max values on y axis
                     expand=c(0,0),
                     breaks=c(0,0.2,0.4,0.6,0.8,1.0)) +
  scale_x_continuous(limits=c(0.011, 0.018),
                     breaks=c(0.010,0.012,0.014,0.016,0.018)) #change min and max values on x axis


# Disable clip-area.
gt &lt;- ggplot_gtable(ggplot_build(c))
gt$layout$clip[gt$layout$name == &quot;panel&quot;] &lt;- &quot;off&quot;
grid.draw(gt)</code></pre>
<p><img src="/post/lionfish-data-analysis/index_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/lionfish/">lionfish</a>
  
  <a class="badge badge-light" href="/tags/diet/">diet</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/projects/lionfish-diet-choice/&amp;text=Lionfish%20diet%20choice%20experiment" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/projects/lionfish-diet-choice/&amp;t=Lionfish%20diet%20choice%20experiment" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Lionfish%20diet%20choice%20experiment&amp;body=/projects/lionfish-diet-choice/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/projects/lionfish-diet-choice/&amp;title=Lionfish%20diet%20choice%20experiment" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Lionfish%20diet%20choice%20experiment%20/projects/lionfish-diet-choice/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/projects/lionfish-diet-choice/&amp;title=Lionfish%20diet%20choice%20experiment" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_huffb4d53348bcda60806672fdf1cbbc40_3474884_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Amelia L. Ritger</a></h5>
      <h6 class="card-subtitle">PhD Student</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:aritger@ucsb.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=fTXo-jMAAAAJ&amp;hl=en&amp;oi=ao" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/ameliaritger" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/ameliaritger" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/publication/mpb/">Bioaccumulation of mercury and other metal contaminants in invasive lionfish (Pterois volitans/miles) from Curaçao</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.a0d331bcd05dbe8b31e244f796710f08.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
