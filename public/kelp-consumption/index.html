<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Amelia L. Ritger">

  
  
  
    
  
  <meta name="description" content="This project explored how intraspecific variation might play a role in the ability of the strawberry anemone (Corynactis californica) to act as a deterrent to urchin foraging.
Purple urchins, starved for a minimum of 7 days, were placed in aquaria containing kelp (Macrocystis pyrifera) protected by a barrier of strawberry anemones. 3 color morphs of strawberry anemones were used (Red, Pink, and Orange) in trials to assess any differences in the ability of genets (genetically identical individuals) to deter urchins from grazing on kelp.">

  
  <link rel="alternate" hreflang="en-us" href="/kelp-consumption/">

  


  
  
  
  <meta name="theme-color" content="#A82D0F">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alice%7CAlegreya%7CPlayfair+Display%7CCrimson+Text%7CCabin&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/kelp-consumption/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@ameliaritger">
  <meta property="twitter:creator" content="@ameliaritger">
  
  <meta property="og:site_name" content="Amelia L. Ritger">
  <meta property="og:url" content="/kelp-consumption/">
  <meta property="og:title" content="Urchin deterrence experiment | Amelia L. Ritger">
  <meta property="og:description" content="This project explored how intraspecific variation might play a role in the ability of the strawberry anemone (Corynactis californica) to act as a deterrent to urchin foraging.
Purple urchins, starved for a minimum of 7 days, were placed in aquaria containing kelp (Macrocystis pyrifera) protected by a barrier of strawberry anemones. 3 color morphs of strawberry anemones were used (Red, Pink, and Orange) in trials to assess any differences in the ability of genets (genetically identical individuals) to deter urchins from grazing on kelp."><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-09-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-09-01T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Urchin deterrence experiment | Amelia L. Ritger</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Amelia L. Ritger</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Amelia L. Ritger</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#research"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects/"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#mentorship"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Urchin deterrence experiment</h1>

  

  
    


<div class="article-metadata">

  
  

  

  

  

  
  
  

  
  

</div>

    













<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/ameliaritger/Ritger-2019-Corynactis-urchin-deterrence" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Repository
  </a>


</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>This project explored how intraspecific variation might play a role in the ability of the strawberry anemone (Corynactis californica) to act as a deterrent to urchin foraging.</p>
<p>Purple urchins, starved for a minimum of 7 days, were placed in aquaria containing kelp (Macrocystis pyrifera) protected by a barrier of strawberry anemones. 3 color morphs of strawberry anemones were used (Red, Pink, and Orange) in trials to assess any differences in the ability of genets (genetically identical individuals) to deter urchins from grazing on kelp. Kelp consumption by urchins was measured using photos taken of kelp blades before and after experimental trials, which lasted between 19:00 and 7:00 (30 minutes before and after sunrise and sunset, respectively) in late August-early September. Urchin behavior was tracked using photos (taken by GoPro Hero3+) of the experimental set up each minute for approximately 5 hours at the start of each experiment. Urchin behavior was compared between genets to examine how intraspecific variation might play a role in the associational refuge offered by the strawberry anemone to macroalgae in temperate kelp forests.</p>
<p>The following code works through data organization and analysis of urchin foraging behavior ( minus video analysis), analysis using logistic regression treating binary kelp consumption (yes/no) as a Bernoulli distribution and mixed model ANOVA treating tile as a random effect in kelp consumption by urchins</p>
<div id="load-packages-load-data-tidy-data" class="section level3">
<h3>Load packages, load data, tidy data</h3>
<pre class="r"><code>#LOAD PACKAGES
library(tidyverse)
library(zoo)
library(GGally)
library(ggplot2)
library(janitor)
library(here)

## LOAD DATA
data &lt;- read.csv(&quot;raw.csv&quot;)

## TIDY DATA
# my own OCD, fix &quot;Trial&quot; issue
colnames(data)[colnames(data)==&quot;ï..Trial.number&quot;] &lt;- &quot;Trial&quot;

# Clean names for R
data &lt;- data %&gt;%
  clean_names()

# To remove instances where we have video evidence of urchins not moving (and not eating kelp)
data &lt;- data[(data$urchin_deterred_during_video!=&quot;urchin never tried&quot; | data$kelp_visibly_consumed==&quot;yes&quot;),]

# To compare across treatments, presence/absence of Corynactis
data$corynactis_binary &lt;- ifelse(data$treatment_number&gt;1, &quot;present&quot;, &quot;absent&quot;)

# Create variables: kelp area consumed, percent kelp consumed
data &lt;- data %&gt;%
  mutate(area_consumed=(kelp_before_cm_2-kelp_after_cm_2)) %&gt;%
  mutate(percent_consumed=(area_consumed/kelp_before_cm_2))

# look at &quot;minimum % kelp consumed cutoff&quot; contradictions between ImageJ and visual analysis
#datan &lt;- subset(data, Visible_consumption==&quot;no&quot;)
#datay &lt;- subset(data, Visible_consumption==&quot;yes&quot;)
#sort(datan$percent_consumed) #If any percent consumption is less than 0.04, we assume there was no consumption (aka &#39;remove&#39; ImageJ analysis error)...minus the one piece of kelp that definitely had a tiny bit of urchin chewing it
#data$percent_corrected &lt;- ifelse(data$`Percent of Kelp Consumed`&gt;0.04, data$`Percent of Kelp Consumed`, 0)
data$percent_corrected &lt;- ifelse(data$kelp_visibly_consumed==&quot;no&quot;, 0, data$percent_consumed)
data$area_corrected &lt;- ifelse(data$kelp_visibly_consumed==&quot;no&quot;, 0, data$area_consumed)

# To compare consumption (yes, no) across treatments
data$consumption_binary &lt;- ifelse(data$percent_corrected&gt;0, 1, 0)

# Average urchin body weight before and after trials
data &lt;- data %&gt;%
  mutate(urchin_avg_g = rowMeans(cbind(urchin_weight_before_g,urchin_weight_after_g)))

# To see if balcony versus wet lab location had an effect
data$experiment_location &lt;- ifelse(data$tank_number&gt;6, &quot;Balcony&quot;, &quot;Lab&quot;)

# take averages (kelp consumption) of each tile, create new data frame from subsetted averages
# keep all control values rather than average them (if I pursue averaging repeated tiles), assign each control trial a unique number
#data$cory_tile_number[data$cory_tile_number==0] &lt;- c(-1:-15)</code></pre>
</div>
<div id="visualize-the-data" class="section level3">
<h3>Visualize the data</h3>
<pre class="r"><code>ggplot(data, aes(y=area_corrected, x=treatment)) +
  geom_boxplot() +
  geom_jitter(size=1.5,alpha=0.9, width=0.1) +
  labs(x=&quot;Treatment&quot;, y=expression(&quot;Kelp area consumed &quot;(~cm^2))) +
  theme_bw()</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-2-1.png" width="400px" height="300px" /></p>
<p>It looks like there are a lot more zeroes in the experimental treatments versus the control treatment so…</p>
</div>
<div id="is-there-any-difference-between-urchins-that-ate-or-didnt-eat-kelp" class="section level2">
<h2>Is there any difference between urchins that ate or didn’t eat kelp?</h2>
<div id="rough-visualization-of-distribution-using-chi-square-test" class="section level4">
<h4>Rough visualization of distribution using chi-square test</h4>
<pre class="r"><code>####################################################
# Tiered Analysis: Urchins that ate vs didn&#39;t eat kelp
####################################################
library(corrplot)
library(boot)
library(spdep)
library(DCluster)

# assign variables
treat &lt;- as.factor(data$treatment)
eat &lt;- data$consumption_binary
cory &lt;- data$corynactis_binary

# Chi-square test for kelp consumption versus no consumption for yes/no Corynactis
t1 &lt;-table(cory, eat)
chisq.test(cory,eat)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  cory and eat
## X-squared = 2.2096, df = 1, p-value = 0.1372</code></pre>
<pre class="r"><code># Chi-square test for kelp consumption versus no consumption across treatments
t1 &lt;- table(treat, eat)
chisq.test(t1)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  t1
## X-squared = 5.9308, df = 3, p-value = 0.115</code></pre>
<pre class="r"><code>## from fifer package (which no longer exists)
chisq.post.hoc &lt;- function(tbl,test=c(&quot;fisher.test&quot;), popsInRows=TRUE,control=c(&quot;fdr&quot;,&quot;BH&quot;,&quot;BY&quot;,&quot;bonferroni&quot;,&quot;holm&quot;,&quot;hochberg&quot;,&quot;hommel&quot;),digits=4, ...) {
    #### extract correction method
  control &lt;- match.arg(control)
    #### extract which test (fisher or chi square) 
  test = match.fun(test)
    #### test rows or columns
  if (!popsInRows) tbl &lt;- t(tbl)
  popsNames &lt;- rownames(tbl)
    #### come up with all possible comparisons
  prs &lt;- combn(1:nrow(tbl),2)
    #### preallocate  
  tests &lt;- ncol(prs)
  pvals &lt;- numeric(tests)
  lbls &lt;- character(tests)
  for (i in 1:tests) {
    pvals[i] &lt;- test(tbl[prs[,i],], ...)$p.value
    lbls[i] &lt;- paste(popsNames[prs[,i]],collapse=&quot; vs. &quot;)
  }
  adj.pvals &lt;- p.adjust(pvals,method=control)
  cat(&quot;Adjusted p-values used the&quot;,control,&quot;method.\n\n&quot;)
  data.frame(comparison=lbls,raw.p=round(pvals,digits),adj.p=round(adj.pvals,digits))
}

chisq.post.hoc(t1, control = &quot;bonferroni&quot;, popsInRows  = TRUE)</code></pre>
<pre><code>## Adjusted p-values used the bonferroni method.</code></pre>
<pre><code>##           comparison  raw.p  adj.p
## 1 Control vs. Orange 0.4513 1.0000
## 2   Control vs. Pink 0.2828 1.0000
## 3    Control vs. Red 0.0329 0.1974
## 4    Orange vs. Pink 1.0000 1.0000
## 5     Orange vs. Red 0.1939 1.0000
## 6       Pink vs. Red 0.3175 1.0000</code></pre>
<p>Control and Red are different</p>
</div>
</div>
<div id="what-is-the-effect-of-corynactis-color-on-whether-or-not-urchins-ate-kelp-averaged-amongst-tiles" class="section level2">
<h2>What is the effect of Corynactis color on whether or not urchins ate kelp (averaged amongst tiles)?</h2>
<div id="treat-the-data-as-bernoulli-sucesses-vs.-failures" class="section level4">
<h4>Treat the data as Bernoulli (sucesses vs. failures)</h4>
<p>Because not every tile was actually used twice (thanks to urchins not moving, etc), get the total counts each tile was used and add it as a column to data frame</p>
<pre class="r"><code>data &lt;- data[order(data$cory_tile_number),] #sort whole data frame by tile number

df &lt;- data # separate this organization from the whole data frame in case you mess something up

df &lt;- df[order(df$cory_tile_number),] #sort subsetted data frame by tile number

df$cory_tile_number[df$cory_tile_number==0] &lt;- c(-1:-15) #change all controls to unique negative numbers to get count values

new &lt;- count(df, cory_tile_number) #count values for each tile number

duptimes &lt;- c(new$n) #how many replicates I want of each row

indx &lt;- rep(1:nrow(new), duptimes) # Create an index of the rows I want with duplications
dupdf &lt;- new[indx,] # Use that index to generate new data frame
dupdf$cory_tile_number[1:15] &lt;-0 #change control values back to tile number &quot;0&quot;
dupdf$n[1:15] &lt;- 15 #change duplications for control tiles to 15
data$count_per_tile &lt;- dupdf$n #add the counts to the whole data frame

#now put it all together 
#library(dplyr)
data_avg &lt;- data %&gt;%
  group_by(cory_tile_number) %&gt;%                                     # group tile numbers together
  mutate(success=sum(consumption_binary, na.rm=TRUE)) %&gt;%     #number of successes
  mutate(failure=ifelse(count_per_tile==2, abs(success-2), ifelse(count_per_tile==1,abs(success-1), 3))) %&gt;%  #number of failures, given number of times tile was used
  mutate(binary_avg=mean(consumption_binary, na.rm=TRUE)) %&gt;% #average successes/total attempts
  mutate(avg_area=mean(area_consumed, na.rm=TRUE))  %&gt;%       # mean kelp consumption of each tile group
  mutate(avg_percent=mean(percent_consumed, na.rm=TRUE)) %&gt;%  # mean % kelp consumption of each tile group
  ungroup() %&gt;%                                               # ungroup data REALLY IMPT when using group_by
  distinct(cory_tile_number, .keep_all = TRUE) %&gt;%                   # remove duplicate tiles
  dplyr::select(treatment, cory_tile_number, urchin_avg_g, success, failure, binary_avg, count_per_tile, kelp_before_cm_2, kelp_after_cm_2, area_corrected) # clean up! extract only columns you want</code></pre>
<pre class="r"><code>#create the model
library(lme4)

#treating the data as bernoulli, sucesses given failures amongst treatments and tiles
m1 &lt;- glm(cbind(success, count_per_tile-success) ~ treatment, family = binomial , data = data_avg)
summary(m1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = cbind(success, count_per_tile - success) ~ treatment, 
##     family = binomial, data = data_avg)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9985  -0.3789  -0.3183   0.9756   1.9437  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)       1.3863     0.6455   2.148   0.0317 *
## treatmentOrange  -0.8473     0.8018  -1.057   0.2906  
## treatmentPink    -0.9343     0.8065  -1.158   0.2467  
## treatmentRed     -1.8383     0.8065  -2.279   0.0226 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 37.621  on 30  degrees of freedom
## Residual deviance: 31.533  on 27  degrees of freedom
## AIC: 63.099
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<pre class="r"><code>aov(m1)</code></pre>
<pre><code>## Call:
##    aov(formula = m1)
## 
## Terms:
##                 treatment Residuals
## success          118.4968   10.6000
##                   5.60968  11.10000
## Deg. of Freedom         3        27
## 
## Residual standard errors: 0.6265721 0.6411795
## Estimated effects may be unbalanced</code></pre>
</div>
</div>
<div id="among-the-urchins-that-ate-does-corynactis-matter-in-how-much-kelp-was-consumed" class="section level2">
<h2>Among the urchins that ate, does Corynactis matter in how much kelp was consumed?</h2>
<div id="look-at-univariate-distribution-of-kelp-consumption" class="section level4">
<h4>Look at univariate distribution of kelp consumption</h4>
<pre class="r"><code># create new data frame for instances where urchins ate something (not nothing)
data_consumption &lt;- subset(data, data$area_corrected&gt;0)

# Univariate analysis for Y
hist(data_consumption$area_corrected, main=&quot;&quot;) #looks fine</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-6-1.png" width="400px" height="300px" /></p>
<pre class="r"><code>boxplot(data_consumption$area_corrected) #2 outliers</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-6-2.png" width="400px" height="300px" /></p>
<pre class="r"><code>qqnorm(data_consumption$area_corrected)
qqline(data_consumption$area_corrected) #could be better, but let&#39;s look at the model/residuals</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-6-3.png" width="400px" height="300px" /></p>
</div>
<div id="maybe-remove-two-outliers" class="section level4">
<h4>Maybe remove two outliers?</h4>
<pre class="r"><code># Isolate outliers in data
outliers &lt;- boxplot(data_consumption$area_corrected)$out</code></pre>
<pre class="r"><code>data_consumption &lt;- data_consumption[-which(data_consumption$area_corrected %in% outliers),]</code></pre>
<pre class="r"><code># Univariate analysis for Y (minus outliers)
hist(data_consumption$area_corrected, main=&quot;&quot;)</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-8-1.png" width="400px" height="300px" /></p>
<pre class="r"><code>boxplot(data_consumption$area_corrected)</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-8-2.png" width="400px" height="300px" /></p>
<pre class="r"><code>qqnorm(data_consumption$area_corrected)
qqline(data_consumption$area_corrected)</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-8-3.png" width="400px" height="300px" /></p>
<p>Sure, looks better</p>
</div>
<div id="now-visualize-the-relationship-between-treatment-and-kelp-consumption" class="section level4">
<h4>Now visualize the relationship between treatment and kelp consumption</h4>
<pre class="r"><code>ggplot(data_consumption,aes(x=corynactis_binary,y=area_corrected))+
  geom_boxplot()+
  geom_jitter()+
  labs(x=&quot;Treatment&quot;, y=expression(&quot;Kelp area consumed, when consumed &quot;(~cm^2))) +
  theme_bw()</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-9-1.png" width="400px" height="300px" /></p>
<pre class="r"><code>ggplot(data_consumption,aes(x=treatment,y=area_corrected))+
  geom_boxplot()+
  geom_jitter()+
  labs(x=&quot;Treatment&quot;, y=expression(&quot;Kelp area consumed, when consumed &quot;(~cm^2))) +
  theme_bw()</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-10-1.png" width="400px" height="300px" /></p>
<p>There really is no apparent relationship between presence/absence Corynactis or Treatment and the amount of kelp consumed, but let’s run stats anyway for good measure</p>
</div>
<div id="mixed-model-anova" class="section level3">
<h3>Mixed model ANOVA</h3>
<div id="treatment-is-a-fixed-effect-tile-number-is-a-random-effect" class="section level4">
<h4>Treatment is a fixed effect, tile number is a random effect</h4>
<pre class="r"><code># add tile as a random effect
library(lmerTest)
m2 &lt;- lmer(area_corrected ~ treatment + (1|cory_tile_number), data = data_consumption)
summary(m2)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: area_corrected ~ treatment + (1 | cory_tile_number)
##    Data: data_consumption
## 
## REML criterion at convergence: 277.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.2553 -0.8677  0.3024  0.6240  1.5906 
## 
## Random effects:
##  Groups           Name        Variance Std.Dev.
##  cory_tile_number (Intercept)  2.676   1.636   
##  Residual                     98.903   9.945   
## Number of obs: 40, groups:  cory_tile_number, 23
## 
## Fixed effects:
##                 Estimate Std. Error      df t value Pr(&gt;|t|)
## (Intercept)      21.9241     3.3043  0.2185   6.635    0.489
## treatmentOrange   2.5179     4.4151  0.5975   0.570    0.714
## treatmentPink     1.6795     4.4988  0.6508   0.373    0.795
## treatmentRed      1.5188     5.6076  1.3136   0.271    0.823
## 
## Correlation of Fixed Effects:
##             (Intr) trtmnO trtmnP
## tretmntOrng -0.748              
## treatmntPnk -0.734  0.550       
## treatmentRd -0.589  0.441  0.433</code></pre>
<pre class="r"><code>anova(m2)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##           Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F)
## treatment 32.676  10.892     3     2  0.1101 0.9466</code></pre>
<pre class="r"><code># let&#39;s look at the residuals
data_consumption$predicted &lt;- predict(m2)
data_consumption$residuals &lt;- residuals(m2)
plot(residuals~predicted, data=data_consumption) #looks fine
abline(0, 0)</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-11-1.png" width="400px" height="300px" /></p>
<p>Yep, as suspected, there was no effect of treatment on amount of kelp consumed by urchins, when any kelp was consumed</p>
</div>
</div>
</div>
<div id="so-in-conclusion" class="section level1">
<h1>So, in conclusion:</h1>
<ul>
<li><h4 id="red-color-morph-increases-probability-urchin-will-fail-to-eat-any-kelp">Red color morph increases probability urchin will fail to eat any kelp</h4></li>
<li><h4 id="but-there-was-no-effect-of-color-morph-or-even-the-simple-presence-of-corynactis-on-amount-of-kelp-consumed-when-looking-only-at-urchins-that-did-consume-kelp">But there was no effect of color morph (or even the simple presence of Corynactis) on amount of kelp consumed, when looking only at urchins that did consume kelp</h4></li>
</ul>
<div id="here-are-a-few-plots-that-might-be-useful-for-presentations" class="section level3">
<h3>Here are a few plots that might be useful for presentations</h3>
<pre class="r"><code>a &lt;- data %&gt;%
  group_by(treatment) %&gt;%
  tally() %&gt;%
  ungroup() #(15,19,18,18)

b &lt;- data %&gt;%
  group_by(treatment) %&gt;%   
  summarise(consumption_binary = sum(consumption_binary)) %&gt;%
  ungroup() #(12,12,11,7)

prop &lt;- merge(a,b)

prop &lt;- prop %&gt;%
  mutate(no_eat = n-consumption_binary,
         no_eat_pcnt = no_eat/n,
         eat_pcnt = consumption_binary/n)

# vertical plot with color coding 
ggplot(data=prop, aes(x=treatment, y=eat_pcnt)) +
  geom_col(aes(fill=treatment), show.legend=FALSE) +
  scale_fill_manual(values=c(&quot;cadetblue4&quot;, &quot;orange&quot;, &quot;pink&quot;, &quot;red&quot;)) + #manually change point colors
  labs(x=&quot;Treatment&quot;, y=&quot;Proportion of urchins that consumed kelp&quot;) +
  geom_text(aes(label=c(&quot;A&quot;, &quot;AB&quot;, &quot;AB&quot;, &quot;B&quot;)), vjust=-1, size=4.5) +
  scale_y_continuous(limits=c(0,1),expand = c(0,0), breaks=c(0,0.2,0.4,0.6,0.8,1)) +
  theme(panel.grid.major.y  = element_line(color = &quot;grey90&quot;),
      panel.background = element_rect(fill = &quot;white&quot;),
      panel.border = element_rect(color = &quot;white&quot;, fill = NA),
      axis.line = element_line(color = &quot;black&quot;),
      axis.ticks = element_line(color = &quot;black&quot;),
      axis.text = element_text(color = &quot;black&quot;, size=12),
      axis.title.y = element_text(vjust=4, size=14),
      axis.title.x = element_text(size=14),
      plot.margin=unit(c(0.5,0,0.2,0.5), &quot;cm&quot;))</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-12-1.png" width="400px" height="300px" /></p>
<pre class="r"><code># vertical plot with image coding (?!)
library(ggtextures)
ggplot(data=prop, aes(x=treatment, y=eat_pcnt, image=c(
    &quot;https://live.staticflickr.com/7344/16596942925_ecbb1fed55_h.jpg&quot;,
    &quot;https://github.com/stier-lab/Ritger-2019-Corynactis-urchin-deterrence/blob/master/media/orange.jpg?raw=true&quot;,
    &quot;https://github.com/stier-lab/Ritger-2019-Corynactis-urchin-deterrence/blob/master/media/pink.jpg?raw=true&quot;,
    &quot;https://github.com/stier-lab/Ritger-2019-Corynactis-urchin-deterrence/blob/master/media/red.jpg?raw=true&quot;))) +
  geom_col(aes(fill=treatment), show.legend=FALSE) +
  ggtextures::geom_textured_col(img_width=unit(3,&quot;in&quot;)) +
  labs(x=&quot;Treatment&quot;, y=&quot;Proportion of urchins that consumed kelp&quot;) +
  geom_text(aes(label=c(&quot;A&quot;, &quot;AB&quot;, &quot;AB&quot;, &quot;B&quot;)), vjust=-1, size=4.5) +
  scale_y_continuous(limits=c(0,1),expand = c(0,0), breaks=c(0,0.2,0.4,0.6,0.8,1)) +
  theme(panel.grid.major.y  = element_line(color = &quot;grey90&quot;),
      panel.background = element_rect(fill = &quot;white&quot;),
      panel.border = element_rect(color = &quot;white&quot;, fill = NA),
      axis.line = element_line(color = &quot;black&quot;),
      axis.ticks = element_line(color = &quot;black&quot;),
      axis.text = element_text(color = &quot;black&quot;, size=12),
      axis.title.y = element_text(vjust=4, size=14),
      axis.title.x = element_text(size=14),
      plot.margin=unit(c(0.5,0,0.2,0.5), &quot;cm&quot;))</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-12-2.png" width="400px" height="300px" /></p>
<p>Let’s see how it looks flipped</p>
<pre class="r"><code>ggplot(data=prop, aes(x=fct_reorder(treatment, -eat_pcnt), y=eat_pcnt)) +
  geom_col(aes(fill=treatment), show.legend=FALSE) +
  scale_fill_manual(values=c(&quot;cadetblue4&quot;, &quot;orange&quot;, &quot;pink&quot;, &quot;red&quot;)) + #manually change point colors
  labs(x=expression(~italic(Corynactis)~&#39; color morph&#39;), y=&quot;Proportion of urchins that consumed kelp&quot;) +
  geom_text(aes(label=c(&quot;B&quot;, &quot;AB&quot;, &quot;AB&quot;, &quot;A&quot;)), hjust=-1, size=5) +
  geom_text(label=c(&quot;(n=15)&quot;, &quot;(n=19)&quot;, &quot;(n=18)&quot;, &quot;(n=18)&quot;), color=c(&quot;white&quot;,&quot;black&quot;,&quot;black&quot;,&quot;black&quot;), y=0.07, size=3.5) +
  scale_y_continuous(limits=c(0,1),expand = c(0,0), breaks=c(0,0.2,0.4,0.6,0.8,1)) +
  coord_flip() +
  theme(panel.grid.major.x  = element_line(color = &quot;grey90&quot;),
      panel.background = element_rect(fill = &quot;white&quot;),
      panel.border = element_rect(color = &quot;white&quot;, fill = NA),
      axis.line = element_line(color = &quot;black&quot;),
      axis.ticks = element_line(color = &quot;black&quot;),
      axis.text = element_text(color = &quot;black&quot;, size=16),
      axis.title.y = element_text(vjust=4, size=18),
      axis.title.x = element_text(size=18),
      plot.margin=unit(c(0,0.5,0.2,0.5), &quot;cm&quot;))</code></pre>
<p><img src="/post/cory-urchin-data-analysis/index_files/figure-html/unnamed-chunk-13-1.png" width="400px" height="300px" /></p>
</div>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/kelp-forest/">kelp forest</a>
  
  <a class="badge badge-light" href="/tags/purple-urchin/">purple urchin</a>
  
  <a class="badge badge-light" href="/tags/corynactis/">corynactis</a>
  
  <a class="badge badge-light" href="/tags/species-interaction/">species interaction</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/kelp-consumption/&amp;text=Urchin%20deterrence%20experiment" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/kelp-consumption/&amp;t=Urchin%20deterrence%20experiment" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Urchin%20deterrence%20experiment&amp;body=/kelp-consumption/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/kelp-consumption/&amp;title=Urchin%20deterrence%20experiment" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Urchin%20deterrence%20experiment%20/kelp-consumption/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/kelp-consumption/&amp;title=Urchin%20deterrence%20experiment" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>















  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.a0d331bcd05dbe8b31e244f796710f08.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
